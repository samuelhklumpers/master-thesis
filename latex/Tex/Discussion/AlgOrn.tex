\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--type-in-type}\AgdaSpace{}%
\AgdaPragma{--with-K}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Tex.Discussion.AlgOrn}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Primitive}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}%
\>[11]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPostulate{Level}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{SSet}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}%
\>[12I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-zero}\<%
\\
\>[.][@{}l@{}]\<[12I]%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{lsuc}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-suc}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}‚äî\AgdaUnderscore{}}}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{‚Ñì-max}}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Set}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Setœâ}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Typeœâ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{J}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Vec}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{fst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{snd}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Desc}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.OrnDesc}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Numerical}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≤}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä¥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
%
\>[2]\AgdaGeneralizable{I}\AgdaSpace{}%
\AgdaGeneralizable{J}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaGeneralizable{X}\AgdaSpace{}%
\AgdaGeneralizable{Y}\AgdaSpace{}%
\AgdaGeneralizable{Z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaGeneralizable{Œõ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tel}\AgdaSpace{}%
\AgdaGeneralizable{P}\<%
\\
%
\>[2]\AgdaGeneralizable{D}\AgdaSpace{}%
\AgdaGeneralizable{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{I}\<%
\\
%
\>[2]\AgdaGeneralizable{U}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{W}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\<%
\\
%
\>[2]\AgdaGeneralizable{CD}\AgdaSpace{}%
\AgdaGeneralizable{CE}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{I}\<%
\\
%
\>[2]\AgdaGeneralizable{V‚Ä≤}\AgdaSpace{}%
\AgdaGeneralizable{W‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Info}\<%
\end{code}

%<*almost-algorn>
\begin{code}%
\>[0]\AgdaFunction{algOrn}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{J}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Desc}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaGeneralizable{I}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßD}}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚á∂}}\AgdaSpace{}%
\AgdaBound{J}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Œ£}\AgdaSpace{}%
\AgdaGeneralizable{I}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{J}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaField{fst}\AgdaSpace{}%
\AgdaBound{D}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaFunction{algOrnC}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{W}\AgdaSpace{}%
\AgdaBound{J}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Con}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßC}}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{fst}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrnDesc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{Œ£}\AgdaSpace{}%
\AgdaGeneralizable{I}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{J}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaField{fst}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{algOrn}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[16]\AgdaBound{œï}%
\>[19]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{algOrn}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}%
\>[16]\AgdaBound{œï}%
\>[19]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{algOrnC}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{fst}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\>[19]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{algOrn}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{algOrnC}%
\>[9]\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{pv}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{pv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaBound{pv}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{algOrnC}%
\>[9]\AgdaSymbol{\{}\AgdaArgument{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{J}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ+}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{\})}\<%
\\
%
\>[9]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{OœÅ0}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{algOrnC}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaField{fst}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}))}\<%
\\
\>[0]\AgdaFunction{algOrnC}%
\>[9]\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OœÉ+}\AgdaSpace{}%
\AgdaBound{S}\<%
\\
%
\>[9]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{algOrnC}%
\>[20]\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{VxfO-‚ñ∑}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{S}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}))}\<%
\\
\>[0]\AgdaFunction{algOrnC}%
\>[9]\AgdaSymbol{\{}\AgdaArgument{I}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{J}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{algOrnC}%
\>[20]\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{VxfO-‚ñ∑}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[20]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{pw}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{pw}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}))}\<%
\end{code}
%</almost-algorn>

%<*almost-algorn2>
algOrn2  : ‚àÄ {J : ‚ä§ ‚Üí ‚ä§ ‚Üí Type} (D : DescI If Œì ‚ä§)
         ‚Üí InfoF If Number
         ‚Üí (‚àÄ p i ‚Üí ‚ü¶ D ‚üßD (Œª _ _ ‚Üí J tt tt) p i ‚Üí J tt tt)
         ‚Üí OrnDesc Plain Œì id (J tt tt) ! D
         
algOrn2C  : ‚àÄ {W} {J : ‚ä§ ‚Üí ‚ä§ ‚Üí Type} (C : ConI If Œì V ‚ä§)
          ‚Üí InfoF If Number
          ‚Üí (c : VxfO id W V)
          ‚Üí (‚àÄ p i ‚Üí ‚ü¶ C ‚üßC (Œª p i ‚Üí J tt tt) (over c p) i ‚Üí J tt tt)
          ‚Üí ConOrnDesc {Œî = Œì} {W = W} {J = J tt tt} Plain c ! C

algOrn2 []       iff œï  = []
algOrn2 (C ‚à∑ D)  iff œï  = algOrn2C C iff id (Œª p i x ‚Üí œï (fst p) i (inj‚ÇÅ x))
                        ‚à∑ algOrn2 D iff Œª p i x ‚Üí œï p i (inj‚ÇÇ x)

algOrn2C  (ùüô j) iff c œï = ùüô (Œª pv ‚Üí œï pv tt refl) (Œª a ‚Üí refl)
algOrn2C  {J = J} (œÅ j g C) iff c œï
          = OŒîœÉ+ (Œª _ ‚Üí J tt tt)
          ( œÅ (Œª { (_ , (_ , i)) ‚Üí i }) g (Œª _ ‚Üí refl) (Œª a ‚Üí refl)
          ( algOrn2C C iff (c ‚àò fst) Œª { (p , w , j) i x ‚Üí œï (p , w) tt (j , x) }))
algOrn2C  (œÉ S h C) iff c œï
          = OœÉ+ S
          ( algOrn2C C iff (h ‚àò VxfO-‚ñ∑ c S)
                    Œª { (p , w , s) i x ‚Üí œï (p , w) i (s , x) })
algOrn2C  {J = J} (Œ¥ {if = if‚Ä≤} {iff = iff‚Ä≤} j g R h C) iff c œï
          with iff .Œ¥f _ _ if‚Ä≤
... | refl , refl , _
          = OŒîœÉ+ (Œª { w ‚Üí Œº R (g (over c w)) (j (over c w)) } )
          ( O‚àôŒ¥+ {!!} ! (algOrn2 R (iff ‚àòInfoF iff‚Ä≤) {!didn't think about what J would actually be here!}) (Œª _ _ ‚Üí refl) (Œª _ _ ‚Üí refl) (algOrn2C C iff _ Œª { (p , (w , r) , z) i x ‚Üí œï (p , w) tt
          (r , subst (Œª a ‚Üí ‚ü¶ C ‚üßC (Œª _ _ ‚Üí J tt tt) (p , h (c w , a)) tt) {!reassuringly/unfortunately?, this is blocked by the same problem as indexed numerical representations!} x) }))
%</almost-algorn2>


-- shortcut is algOrn applied to (toDesc OD) with (ornAlg OD)

shortcut  : {D : DescI If ‚àÖ ‚ä§} {E : DescI If ‚àÖ ‚ä§} (OD : OrnDesc Plain Œì ! I ! D)
          ‚Üí InfoF If Number
          ‚Üí OrnDesc If Œì id (Œ£ I Œª i ‚Üí Œº E _ _) fst (toDesc OD)
         
shortcutC  : ‚àÄ {E : DescI If ‚àÖ ‚ä§} {U W} {f : VxfO ! W V} {g : VxfO id U W}
           ‚Üí {C : ConI If ‚àÖ V ‚ä§}
           ‚Üí (OC : ConOrnDesc {Œî = Œì} {W = W} {J = I} Plain f ! C)
           ‚Üí InfoF If Number
           ‚Üí ConOrnDesc {Œî = Œì} {W = U} {J = Œ£ I Œª i ‚Üí Œº E _ _} If g fst (toCon OC)

shortcut [] iff = []
shortcut (OC ‚à∑ OD) iff
  = shortcutC OC iff 
  ‚à∑ shortcut OD iff  

shortcutC (ùüô j‚Ä≤ x‚ÇÅ) iff = ùüô (Œª pv ‚Üí {!still need a ‚ü¶ toDesc OC ‚üßC (~~ Œº E ~~) ‚á∂ ~~ Œº E ~~ like object here!}) {!!}
shortcutC (œÅ j‚Ä≤ h x‚ÇÅ x‚ÇÇ OC) iff = {!!}
shortcutC (œÉ S h v‚Ä≤ x‚ÇÅ OC) iff = {!!}
shortcutC (Œ¥ R j t h x‚ÇÅ OC) iff = {!!}
shortcutC (ŒîœÉ S h v‚Ä≤ x‚ÇÅ OC) iff = {!!}
shortcutC (ŒîŒ¥ R j t h x‚ÇÅ OC) iff = {!!}
shortcutC (‚àôŒ¥ m fŒõ RR‚Ä≤ h p‚ÇÅ p‚ÇÇ OC) iff = {!!}
