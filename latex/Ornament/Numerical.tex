\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--type-in-type}\AgdaSpace{}%
\AgdaPragma{--with-K}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ornament.Numerical}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Desc}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Orn}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.OrnDesc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Agda.Primitive}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Vec}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Vec}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚â°\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{\AgdaUnderscore{}‚àô\AgdaUnderscore{}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{subst2}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{J}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaGeneralizable{X}\AgdaSpace{}%
\AgdaGeneralizable{Y}\AgdaSpace{}%
\AgdaGeneralizable{Z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tel}\AgdaSpace{}%
\AgdaGeneralizable{P}\<%
\\
%
\>[2]\AgdaGeneralizable{U}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{W}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\<%
\\
%
\>[2]\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Info}\<%
\\
\>[0]\<%
\end{code}

%<*Number>
\begin{code}%
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôi}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅi}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉi}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥i}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\end{code}
%</Number>

%<*toN-type>
\begin{code}%
\>[0]\AgdaFunction{to‚Ñï}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\end{code}
%</toN-type>

\begin{code}%
\>[0]\AgdaFunction{to‚Ñï}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-lift}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{to‚Ñï-lift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaFunction{to‚Ñï-lift}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{If}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{If}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fold}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\end{code}

%<*toN-con>
\begin{code}%
%
\>[4]\AgdaFunction{to‚Ñï-desc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üß}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
%
\>[4]\AgdaFunction{to‚Ñï-con}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üß}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{to‚Ñï-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaFunction{to‚Ñï-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{to‚Ñï-con}%
\>[13]\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôf}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{to‚Ñï-con}%
\>[13]\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[50]\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{to‚Ñï-con}%
\>[13]\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{S‚Üí‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[50]\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{S‚Üí‚Ñï}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{to‚Ñï-con}%
\>[13]\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[50]\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\<%
\\
%
\>[4]\AgdaSymbol{...}%
\>[13]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-lift}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àòInfoF}}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{to‚Ñï-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
%</toN-con>

%<*NatND>
\begin{code}%
\>[0]\AgdaFunction{NatND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{NatND}%
\>[318I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[318I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</NatND>

\begin{code}%
\>[0]\AgdaFunction{BinND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{BinND}%
\>[340I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[340I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{bin-2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaFunction{BinND}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{bin-2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{bin-5}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaFunction{BinND}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{bin-5}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ simple\ the\ number\ system\ underlying\ simple\ finger\ trees}\<%
\\
\>[0]\AgdaFunction{DigND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{DigND}%
\>[407I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[407I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{FingND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{FingND}%
\>[429I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[429I]%
\>[7]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[7]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{Œ¥-}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{DigND}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Œ¥-}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{DigND}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})))}\<%
\\
%
\>[7]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ 1\ ‚ü®\ 0\ ‚ü©\ 1}\<%
\\
\>[0]\AgdaFunction{finger-2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaFunction{FingND}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{finger-2}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ 1\ ‚ü®\ 2\ ‚ü©\ 2}\<%
\\
\>[0]\AgdaFunction{finger-7}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaFunction{FingND}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{finger-7}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{finger-2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}

Theorem: given a number system D, there is a "good container" D', which also satisfies (x : Œº D' A tt) ‚Üí size x ‚â° shape x
%<*TrieO-type>
\begin{code}%
\>[0]\AgdaFunction{TrieO}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{D}\<%
\end{code}
%</TrieO-type>

\begin{code}%
\>[0]\AgdaFunction{TrieO}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{TrieO}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{D}\<%
\end{code}

%<*TrieO-con-type>
\begin{code}%
%
\>[2]\AgdaFunction{TrieO-con}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{V}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{W}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{\}}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\<%
\\
%
\>[13]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{W}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{W}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{K}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{C}\<%
\end{code}
%</TrieO-con-type>

\begin{code}%
%
\>[2]\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[21]\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{f}\<%
\end{code}
  
-- trie (Œª X tt ‚Üí ‚ä§) {to‚Ñï tt ‚Üí k} 
-- ‚áí (Œª X A ‚Üí A^k)
%<*TrieO-1>
\begin{code}%
%
\>[2]\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{ŒîœÉ}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)\})}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaField{proj‚ÇÅ}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\end{code}
%</TrieO-1>

   
-- trie (Œª X tt ‚Üí X tt √ó F X tt) {to‚Ñï (x , y) ‚Üí k * to‚Ñï x + to‚Ñï y}
-- ‚áí (Œª X A ‚Üí X (A ^ k) √ó trie F X A)
%<*TrieO-rho>
\begin{code}%
%
\>[2]\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\})}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
%</TrieO-rho>

-- trie (Œª X tt ‚Üí S √ó F X tt) {to‚Ñï (s , y) ‚Üí if s + to‚Ñï y}
-- ‚áí (Œª X A ‚Üí Œ£[ s ‚àà S ] A^(if s) √ó trie F X A)
%<*TrieO-sigma>
\begin{code}%
%
\>[2]\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{VxfO-‚ñ∑}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{S}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{ŒîœÉ}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\end{code}
%</TrieO-sigma>


-- trie (Œª X tt ‚Üí G tt √ó F X tt) {to‚Ñï (r , y) ‚Üí k * to‚Ñï r + to‚Ñï y}
-- ‚áí (Œª X A ‚Üí trie G (Œº (trie G)) A √ó trie F X A)
%<*TrieO-delta>
\begin{code}%
%
\>[2]\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{‚àôŒ¥}%
\>[8]\AgdaSymbol{\{}\AgdaArgument{f''}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[16]\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{ornForget}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{toOrn}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àòInfoF}}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
%
\>[8]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaFunction{!}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaFunction{TrieO-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaFunction{TrieO-desc}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àòInfoF}}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[4]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
%</TrieO-delta>

-- to prove: size x ‚â° shape x
-- * Œº D is likely to be Traversable when all œÉ's in it are
-- * as every S in a DescI Number ‚àÖ ‚ä§ is necessarily invariant, it is also trivially Traversable

-- to prove: every OrnDesc induces an ornamental algebra
-- to prove: for some appropriate Ix : (D : DescI Number ‚àÖ ‚ä§) ‚Üí Desc ‚àÖ (Œº D tt tt),
--           Ix D is also initial for the algebra of the algebraic ornament induced by the ornamental algebra (yes)

-- to summarize, for every number system, there is an appropriate "list", which has an appropriate "vector"
-- this vector is representable, the list is traversable, and everything still satisfies size ‚â° shape ‚â° index





{- -- older, direct attempt at indexed tries
TrieO-1  : (D : DescI If ‚àÖ ‚ä§) ‚Üí InfoF If Number ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) ! (Œº D tt _) ! D

module _ {D' : DescI If ‚àÖ ‚ä§} where
  TrieO  : (D : DescI If ‚àÖ ‚ä§) ‚Üí InfoF If Number ‚Üí (‚ü¶ D ‚üß (Œº D') tt _ ‚Üí Œº D' tt _) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) ! (Œº D' tt _) ! D
  TrieOC : ‚àÄ {V} {W : ExTel (‚àÖ ‚ñ∑ const Type)} {f : VxfO ! W V} (C : ConI If ‚àÖ ‚ä§ V) ‚Üí InfoF If Number ‚Üí (‚àÄ {p} w ‚Üí ‚ü¶ C ‚üß (Œº D') (tt , f {p = p} w) _ ‚Üí Œº D' tt _) ‚Üí ConOrnDesc Plain {W = W} {K = Œº D' tt _} f ! C
  TrieO-forget : ‚àÄ {If‚Ä≤} {iff : InfoF If‚Ä≤ If} (R : DescI If‚Ä≤ ‚àÖ ‚ä§) {p' : Œ£ ‚ä§ (Œª x ‚Üí Type)} (œï : InfoF If Number) (q : Œº R tt tt) {if : ‚Ñï} s ‚Üí
                 q ‚â° ornForget (toOrn (TrieO-1 R (œï ‚àòInfoF iff))) (tt , Vec (proj‚ÇÇ p') if) {i = q} s
 
  TrieO []      f ix = []
  TrieO (C ‚à∑ D) f ix = TrieOC C f (Œª v x ‚Üí ix (inj‚ÇÅ x)) ‚à∑ TrieO D f (ix ‚àò inj‚ÇÇ)

  TrieOC {f = f} (ùüô {if = if} j) œï ix =                               -- if the number is constantly if here
    ŒîœÉ (Œª { ((_ , A) , _) ‚Üí Vec A (œï .ùüôf if)}) f proj‚ÇÅ                      -- add if A's here
    (ùüô (Œª { ((_ , A) , w) ‚Üí ix w refl })                            -- the index is completely determined by the context
    (const refl)) Œª p ‚Üí refl  
    
  TrieOC {f = f} (œÅ {if = if} j g C) œï ix =                           -- if the number is recursively if * r + n here
    ŒîœÉ (const (Œº D' tt tt)) (f ‚àò proj‚ÇÅ) id                          -- for an index r
    (œÅ (proj‚ÇÇ ‚àò proj‚ÇÇ) (Œª { (_ , A) ‚Üí _ , Vec A (œï .œÅf if) })               -- keep the recursive field at r with parameter A^k
    (TrieOC C œï Œª { (w , r) n ‚Üí ix w (r , n) } )                      -- and compute the rest of the OD, the index is constructed from r and the context
    (Œª p ‚Üí refl) Œª p ‚Üí refl) Œª p ‚Üí refl
    
  TrieOC {f = f} (œÉ S {if = if} h C) œï ix =
    œÉ S id (h ‚àò VxfO-‚ñ∑ f S)
    (ŒîœÉ (Œª { ((_ , A) , _ , s) ‚Üí Vec A (œï .œÉf _ if _ s) }) (h ‚àò _) id
    (TrieOC C œï Œª { ((w , s) , x) n ‚Üí ix w (s , n) })
    Œª p ‚Üí refl) (Œª p ‚Üí refl)

  TrieOC {f = f} (Œ¥ {if = if} {iff = iff} j g R h C) œï ix with œï .Œ¥f _ _ if
  ... | refl , refl , if =
    ŒîœÉ (const (Œº R tt tt)) (f ‚àò proj‚ÇÅ) id
    (ŒîœÉ (const (Œº D' tt tt)) (f ‚àò proj‚ÇÅ ‚àò proj‚ÇÅ) id
    (‚àôŒ¥ (Œª { ((_ , A) , ((w , r) , n)) ‚Üí _ , Vec A if }) (proj‚ÇÇ ‚àò proj‚ÇÅ ‚àò proj‚ÇÇ)
    (TrieOC C œï Œª { (w , r) x ‚Üí ix w (r , x) })
    (TrieO-1 R (œï ‚àòInfoF iff)) (proj‚ÇÅ ‚àò proj‚ÇÅ) (Œª _ _ ‚Üí refl) (Œª _ _ ‚Üí refl) Œª { {p'} (((p , q) , r) , s) ‚Üí cong (Œª q ‚Üí h (f p , q)) (TrieO-forget R œï q s) })
    Œª p ‚Üí refl) Œª p ‚Üí refl

  TrieO-forget R œï (con q) (con s) = {!!}

TrieO-1 D f = TrieO {D' = D} D f con
-}

{-
Bin = Œº BinND tt tt

BTreeOD = TrieO-1 BinND
BTreeD = toDesc ? BTreeOD

BTree : Type ‚Üí Bin ‚Üí Type
BTree A n = Œº BTreeD (_ , A) n

btree-5 : BTree ‚Ñï bin-5
btree-5 = con (inj‚ÇÇ (inj‚ÇÅ (bin-2 , (con (inj‚ÇÇ (inj‚ÇÇ (inj‚ÇÅ (con (inj‚ÇÅ refl) , con (inj‚ÇÅ ({!0!} , refl)) , {!2 * 2!} , refl)))) , {!1!} , refl))))
-}