\begin{document}
\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--type-in-type}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Tex.Discussion.Sigma-Desc}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Primitive}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}%
\>[11]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPostulate{Level}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{SSet}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}%
\>[10I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-zero}\<%
\\
\>[.][@{}l@{}]\<[10I]%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{lsuc}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-suc}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}‚äî\AgdaUnderscore{}}}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{‚Ñì-max}}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Set}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Setœâ}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Typeœâ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}

%<*Leibniz>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{0b}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{1b\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b\AgdaUnderscore{}}}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\end{code}
%</Leibniz>

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
\>[0]\<%
\end{code}

%<*FinB>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{0/1}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{0/2}\AgdaSpace{}%
\AgdaInductiveConstructor{1/2}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{0-1b\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1-1b\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{0-2b\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1-2b\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{FinB}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\<%
\end{code}
%</FinB>



%<*Sigma-Desc>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\>[2]\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\>[2]\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\end{code}
%</Sigma-Desc>



%<*LeibnizD>
\begin{code}%
\>[0]\AgdaFunction{LeibnizŒ£D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{LeibnizŒ£D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{))}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\end{code}
%</LeibnizD>



%<*FinBD>
\begin{code}%
\>[0]\AgdaFunction{FinBŒ£D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Œ£-Desc}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
\>[0]\AgdaFunction{FinBŒ£D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}\<%
\\
%
\>[2]\AgdaSymbol{;}%
\>[151I]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\<%
\\
\>[.][@{}l@{}]\<[151I]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[18]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}%
\>[43]\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}%
\>[18]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[43]\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{;}%
\>[185I]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{))}%
\>[22]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\<%
\\
\>[.][@{}l@{}]\<[185I]%
\>[4]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[18]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}%
\>[43]\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}%
\>[18]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[43]\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\end{code}
%</FinBD>
\end{document}




-- here is the construction of using Paths using lists of constructors
-- it is very hard to combine with the indexed numerical representations

_L+_ : List (ConI If Œì J ‚àÖ) ‚Üí DescI If Œì J ‚Üí DescI If Œì J
[]        L+ D = D
(C ‚à∑ Cs)  L+ D = C ‚à∑ (Cs L+ D)

PathD : (D : DescI Number ‚àÖ ‚ä§) ‚Üí Desc ‚àÖ (Œº D tt tt)
PathD‚Ä≤ : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí Desc ‚àÖ (Œº D tt tt)

PathD E = PathD‚Ä≤ E id-InfoF
PathD‚Ä≤ E if = PathDD E if Œª a b ‚Üí con
  module PathD where
    N : _
    N = Œº E tt tt

    PathDD : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí (‚ü¶ D ‚üß (Œª _ _ ‚Üí N) ‚á∂ Œª _ _ ‚Üí N) ‚Üí Desc ‚àÖ (Œº E tt tt)
    PathDC : (C : ConI If ‚àÖ ‚ä§ V) (if : InfoF If Number) (f : Vxf ‚àÖ W V) ‚Üí (‚àÄ b ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (tt , f b) _ ‚Üí N) ‚Üí List (Con ‚àÖ (Œº E tt tt) W)

    PathDD []      if œï = []
    PathDD (C ‚à∑ D) if œï = PathDC C if id (Œª _ c ‚Üí œï _ _ (inl c)) L+ PathDD D if Œª p i ‚Üí œï p i ‚àò inr

    PathDC (ùüô {if = k} j) if f œï
      = œÉ- (const (Fin (if .ùüôf k))) (ùüô (Œª { (_ , w) ‚Üí œï w refl }))
      ‚à∑ []

    -- looks scary, pretty regular to write down though
    PathDC (œÅ {if = k} j g C) if f œï
      = œÉ- (const (Fin (if .œÅf k))) (œÉ+ (const N) (œÉ+ (Œª { (p , w , _) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , f w) tt }) (œÅ0 (snd ‚àò fst ‚àò snd) (ùüô Œª { (_ , (w , n) , c) ‚Üí œï w (n , c) }))))
      ‚à∑ L.map (œÉ+ (const N)) (PathDC C if (f ‚àò fst) (Œª { (w , n) c ‚Üí œï w (n , c) }))

    PathDC (œÉ S {if = k} h C)     if f œï
      = œÉ+ (Œª { (p , w) ‚Üí S (p , f w) }) (œÉ+ (Œª { (p , w , s) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , h (f w , s)) tt }) (œÉ- (Œª { (p , (w , s) , c) ‚Üí Fin (if .œÉf _ k (p , f w) s) }) (ùüô Œª { (p , (w , s) , c) ‚Üí œï w (s , c) })))
      ‚à∑ L.map (œÉ+ Œª { (p , w) ‚Üí S (p , f w) }) (PathDC C if (h ‚àò Vxf-‚ñ∑ f S) Œª { (w , s) c ‚Üí œï w (s , c) })

    PathDC (Œ¥ {If‚Ä≤ = If‚Ä≤} {if = k} {iff = iff} j g R h C) if f œï with if .Œ¥f _ _ k
    ... | refl , refl , k
      = œÉ- (const (Fin k)) (œÉ+ (const (Œº R tt tt)) (œÉ+ (Œª { (p , w , r) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , h (f w , r)) tt }) (Œ¥- (snd ‚àò fst ‚àò snd) ! (PathD‚Ä≤ R (if ‚àòInfoF iff)) (ùüô Œª { (p , (w , r) , c) ‚Üí œï w (r , c) }))))
      ‚à∑ L.map (Œ¥+ ! ! R) (PathDC C if (Œª { (w , r) ‚Üí h (f w , r) }) Œª { (w , r) c ‚Üí œï w (r , c) })

unŒº : {D : DescI If Œì J} ‚Üí ‚àÄ {p i} ‚Üí Œº D p i ‚âÉ ‚ü¶ D ‚üß (Œº D) p i
unŒº .fst (con x) = x
unŒº .snd .equiv-proof y .fst = con y , Œª i ‚Üí y
unŒº .snd .equiv-proof y .snd (con x , p) = Œ£PathP ((Œª i ‚Üí con (p (~ i))) , Œª j i ‚Üí p (~ j ‚à® i))

PathD-correct : ‚àÄ D n ‚Üí Œº (PathD D) tt n ‚âÉ Fin (value n)
PathD-correct D n = compEquiv unŒº {!compEquiv (go D id-InfoF n) {!!}!}
  where
  open PathD D

  go :  (E : DescI If ‚àÖ ‚ä§) (if : InfoF If Number)
        (c : ‚ü¶ E ‚üß (Œª _ _ ‚Üí N id-InfoF) ‚á∂ (Œª _ _ ‚Üí N id-InfoF))
     ‚Üí  ‚àÄ n ‚Üí ‚ü¶ PathDD id-InfoF E if c ‚üß (Œº (PathD D)) tt n ‚âÉ ‚ü¶ PathDD id-InfoF E if c ‚üß (Œª _ n ‚Üí Fin (value n)) tt n
     
  go2 : (E : ConI If ‚àÖ ‚ä§ V) (if : InfoF If Number) ‚Üí ‚àÄ n v ‚Üí ‚ü¶ {!PathDC!} ‚üß (Œº (PathD D)) (tt , v) n ‚âÉ ‚ü¶ {!!} ‚üß (Œª _ n ‚Üí Fin (value n)) (tt , v) n

  go []       _  _ _ = idEquiv ‚ä•
  go (E ‚à∑ Es) if c n = {!‚ü¶ PathDD id-InfoF (E ‚à∑ Es) if c ‚üß (Œº (PathD D)) tt n!}
  
  --go []       n = {!idEquiv ‚ä•!}
  --go (E ‚à∑ Es) n = {!‚äé-equiv (go2 E n tt) (go Es n)!}

  go2 E n = {!!}


BinID : Desc ‚àÖ (Œº BinND tt tt)
BinID = PathD BinND

BinI : Œº BinND tt tt ‚Üí Type
BinI n = Œº BinID tt n

-- the constructors are
-- i0  : ‚ä• ‚Üí BinI 0
-- 1b1 : 2 ‚Üí BinI n ‚Üí BinI (n 1b)
-- 1b0 : 1 ‚Üí BinI (n 1b)
-- 2b1 : 2 ‚Üí BinI n ‚Üí BinI (n 2b)
-- 2b0 : 2 ‚Üí BinI (n 2b)
-- (I think)

-- like the 3rd index into bin-5
bin-3/5 : BinI bin-5
bin-3/5 = con (inr (inl (# 1 , _ , (refl , ((con (inr (inr (inr (inr (inl (_ , (# 0 , refl)))))))) , refl)))))

ITrieO : (D : DescI Number ‚àÖ ‚ä§) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D tt tt) ! (toDesc (TrieO D))
ITrieO D = ITrieO‚Ä≤ D D id-InfoF
  module ITrieO where
    module _ (D' : DescI Number ‚àÖ ‚ä§) where
      ITrieO‚Ä≤ : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D' tt tt) ! (toDesc (TrieO.TrieO-desc D' D if))
      
      N : _
      N = Œº D' tt tt

      ITrieO-desc : (D : DescI If ‚àÖ ‚ä§) ‚Üí (‚ü¶ D ‚üß (Œª _ _ ‚Üí N) ‚á∂ Œª _ _ ‚Üí N) ‚Üí (if : InfoF If Number) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D' tt tt) ! (toDesc (TrieO.TrieO-desc D' D if))

      ITrieO-con  : ‚àÄ {U V} {W : ExTel (‚àÖ ‚ñ∑ const Type)} {f : VxfO ! U V} {g : VxfO id W U}
                 (C : ConI If ‚àÖ ‚ä§ V) ‚Üí (‚àÄ a b ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (tt , f (g {p = a} b)) _ ‚Üí N) ‚Üí (if : InfoF If Number)
                 ‚Üí ConOrnDesc Plain {W = W} {K = Œº D' tt tt} g ! (toCon {f = f} (TrieO.TrieO-con D' C if))

      ITrieO-desc []      œï if = []
      ITrieO-desc (C ‚à∑ D) œï if = ITrieO-con C (Œª a b x ‚Üí œï tt b (inl x)) if ‚à∑ (ITrieO-desc D (œï ‚àò‚ÇÉ inr) if)
      
      ITrieO-con {f = f} {g = g} (ùüô {if = k} j) œï if
        = œÉ _ id (g ‚àò fst) (ùüô (Œª { (p , w , _) ‚Üí œï p w refl }) Œª p ‚Üí refl) (Œª p ‚Üí refl)

      ITrieO-con {f = f} {g = g} (œÅ {if = k} j h C) œï if
        = ŒîœÉ (const N) (g ‚àò fst) id
        ( œÅ (Œª (p , w , n) ‚Üí n) (Œª { (_ , A) ‚Üí _ , Vec A (if .œÅf k) })
          (ITrieO-con C (Œª { a (u , n) x ‚Üí œï a u (n , x) }) if)
        (Œª p ‚Üí refl) (Œª p ‚Üí refl)) (Œª p ‚Üí refl)
        
      ITrieO-con {f = f} {g = g} (œÉ S {if = k} h C)      œï if
        = œÉ _ id (VxfO-‚ñ∑ g (S ‚àò over f))
        ( œÉ _ id (VxfO-‚ñ∑ (VxfO-‚ñ∑ g (S ‚àò over f)) (Œª { ((_ , A) , _ , s) ‚Üí Vec A (if .œÉf _ k _ s) }))
          (ITrieO-con C (Œª { a ((w , s) , _) x ‚Üí œï a w (s , x) }) if)
        Œª p ‚Üí refl) Œª p ‚Üí refl
        
      ITrieO-con {f = f} {g = g} (Œ¥ {if = k} {iff = iff} j g' R h C) œï if with if .Œ¥f _ _ k
      ... | refl , refl , k
        = ŒîœÉ (const (Œº R tt tt)) (g ‚àò fst) id
        ( ŒîœÉ (const (Œº D' tt tt)) (g ‚àò fst ‚àò fst) id
        ( ‚àôŒ¥ {f'' = VxfO-‚ñ∑-map (g ‚àò fst ‚àò fst)
                     (liftM2 (Œº (toDesc (TrieO.TrieO-desc D' R (if ‚àòInfoF iff)))) (Œª { ((_ , A) , _) ‚Üí tt , Vec A k }) !)
                     (liftM2 (Œº (toDesc (ITrieO-desc R {!!} (if ‚àòInfoF iff)))) (Œª p ‚Üí tt , Vec (id (p .fst) .snd) k) (Œª x ‚Üí snd (snd x)))
                     {!!} }
             (Œª { ((_ , A) , ((w , r) , _)) ‚Üí tt , Vec A k }) (snd ‚àò snd)
          (ITrieO-con C {!Œª { a (((w , r) , n) , _)  x ‚Üí œï a w (r , {!!}) }!} if)
          {!ITrieO R!} id
        (Œª _ _ ‚Üí refl) (Œª _ _ ‚Üí refl) Œª p ‚Üí refl) Œª p ‚Üí refl) Œª p ‚Üí refl
    
      ITrieO‚Ä≤ D if = ITrieO-desc D {!!} if


--(liftM2 (Œº (toDesc (TrieO.TrieO-desc D' R (if ‚àòInfoF iff)))) (Œª { ((_ , A) , _) ‚Üí tt , Vec A k }) !)
--ITrieO-desc R (Œª { a b x ‚Üí œï {!!} {!!} {!!} }) (if ‚àòInfoF iff)

-- to prove: size x ‚â° shape x
-- * Œº D is likely to be Traversable when all œÉ's in it are
-- * as every S in a DescI Number ‚àÖ ‚ä§ is necessarily invariant, it is also trivially Traversable

-- to prove: every OrnDesc induces an ornamental algebra -> doesn't work
-- to prove: for some appropriate Ix : (D : DescI Number ‚àÖ ‚ä§) ‚Üí Desc ‚àÖ (Œº D tt tt),
--           Ix D is also initial for the algebra of the algebraic ornament induced by the ornamental algebra (yes)

-- to summarize, for every number system, there is an appropriate "list", which has an appropriate "vector"
-- this vector is representable, the list is traversable, and everything still satisfies size ‚â° shape ‚â° index

UnitD : DescI Number ‚àÖ ‚ä§
UnitD = ùüô {if = 1} _
      ‚à∑ []


