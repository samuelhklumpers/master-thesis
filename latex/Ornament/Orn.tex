\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--type-in-type}\AgdaSpace{}%
\AgdaPragma{--with-K}\AgdaSpace{}%
\AgdaPragma{--cubical}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ornament.Orn}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Desc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Primitive}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}%
\>[11]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPostulate{Level}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{SSet}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}%
\>[14I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-zero}\<%
\\
\>[.][@{}l@{}]\<[14I]%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{lsuc}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-suc}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}‚äî\AgdaUnderscore{}}}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{‚Ñì-max}}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Set}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Setœâ}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Typeœâ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{J}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{fst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{snd}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{-
open\ import\ Cubical.Data.Equality\ hiding\ (\AgdaUnderscore{}‚ñ∑\AgdaUnderscore{})

open\ import\ Cubical.Data.Unit\ renaming\ (Unit\ to\ ‚ä§)
open\ import\ Cubical.Data.Empty
open\ import\ Cubical.Data.Sigma\ hiding\ (\AgdaUnderscore{}‚â°\AgdaUnderscore{})
open\ import\ Cubical.Data.Sum
open\ import\ Cubical.Data.Nat
-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{J}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaGeneralizable{X}\AgdaSpace{}%
\AgdaGeneralizable{Y}\AgdaSpace{}%
\AgdaGeneralizable{Z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tel}\AgdaSpace{}%
\AgdaGeneralizable{P}\<%
\\
%
\>[2]\AgdaGeneralizable{U}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{W}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≤}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä¥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{transport2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{z}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{w}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{w}\<%
\\
\>[0]\AgdaFunction{transport2}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{b}\<%
\end{code}

Ornaments
%<*Orn-type>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Orn}%
\>[10]\AgdaSymbol{\{}\AgdaBound{If}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{If‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Cxf}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaGeneralizable{J}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\end{code}
%</Orn-type>

%<*ornForget-type>
ornForget : {f : Cxf Œî Œì} {e : K ‚Üí J} {D : DescI If Œì J} {E : DescI If‚Ä≤ Œî K}
          ‚Üí Orn f e D E ‚Üí ‚àÄ p {i} ‚Üí Œº E p i ‚Üí Œº D (f p) (e i)
%</ornForget-type>

All significant squares have diagrams below
%<*ConOrn-type>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{ConOrn}%
\>[13]\AgdaSymbol{\{}\AgdaBound{If}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{If‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Cxf}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaGeneralizable{W}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaGeneralizable{J}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
%</ConOrn-type>

Preserving
%<*Orn-1>
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaInductiveConstructor{ùüô}%
\>[5]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\end{code}
%</Orn-1>
(*)

%<*Orn-rho>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{œÅ}%
\>[5]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\end{code}
%</Orn-rho>

%<*Orn-sigma-delta>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{œÉ}%
\>[5]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}%
\>[10]\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{W'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W'}\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{V}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaBound{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{W}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{S}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{W'}\AgdaSpace{}%
\AgdaBound{V'}\AgdaSymbol{)}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{S}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßtel}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VxfO-‚ñ∑}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{S}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaInductiveConstructor{Œ¥}%
\>[5]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}%
\>[10]\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{W'}\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W'}\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaSymbol{\{}\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\&}}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä¢}}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[10]\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{liftM2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßtel}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{VxfO-‚ñ∑}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{liftM2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{iff}\AgdaSpace{}%
\AgdaBound{iff‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[5]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}%
\>[19]\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\<%
\\
%
\>[19]\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{over}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\end{code}
%</Orn-sigma-delta>

Extending
%<*Orn-+-rho>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{ŒîœÅ}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{h}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\end{code}
%</Orn-+-rho>

%<*Orn-+-sigma-delta>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{ŒîœÉ}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{W'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W'}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßtel}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{fst}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaInductiveConstructor{ŒîŒ¥}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}%
\>[11]\AgdaSymbol{\{}\AgdaBound{W'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W'}\AgdaSymbol{\}}\<%
\\
%
\>[11]\AgdaSymbol{\{}\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{h}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{W}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{liftM2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßtel}}\AgdaSpace{}%
\AgdaBound{p'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{fst}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaBound{f'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if‚Ä≤}\AgdaSpace{}%
\AgdaBound{iff‚Ä≤}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff‚Ä≤}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\end{code}
%</Orn-+-sigma-delta>

Fixing
%<*Orn---sigma-delta>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{‚àáœÉ}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{S}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaBound{S}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{‚äß-‚ñ∑}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaInductiveConstructor{‚àáŒ¥}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}%
\>[11]\AgdaSymbol{\{}\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaGeneralizable{L}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaBound{V'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If‚Ä≤}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{W}\AgdaSymbol{\}}\<%
\\
%
\>[11]\AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Vxf}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚äß}}\AgdaSpace{}%
\AgdaFunction{liftM2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaFunction{‚äß-‚ñ∑}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{if}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\<%
\\
%
\>[6]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{E}\<%
\end{code}
%</Orn---sigma-delta>

Composition
%<*Orn-comp>
  ‚àôŒ¥  : ‚àÄ  {Œò Œõ M L W' V'} {D : ConI If Œì J V'} {E : ConI If‚Ä≤ Œî K W'}
           {R : DescI If‚Ä≥ Œò L} {R' : DescI If‚Ä¥ Œõ M} {c' : Cxf Œõ Œò} {e' : M ‚Üí L}
           {f'' : VxfO c W' V'} {fŒò : V ‚ä¢ ‚ü¶ Œò ‚üßtel tt} {fŒõ : W ‚ä¢ ‚ü¶ Œõ ‚üßtel tt}
           {l : V ‚ä¢ L} {m : W ‚ä¢ M} {g : Vxf _ (V ‚ñ∑ _) V'} {h : Vxf _ (W ‚ñ∑ _) W'}
      ‚Üí ConOrn f'' e D E
      ‚Üí (O : Orn c' e' R R')
      ‚Üí (p‚ÇÅ : ‚àÄ q w ‚Üí c' (fŒõ (q , w)) ‚â° fŒò (c q , f w))
      ‚Üí (p‚ÇÇ : ‚àÄ q w ‚Üí e' (m (q , w))  ‚â° l (c q , f w))
      ‚Üí ( ‚àÄ {p'} (p : ‚ü¶ W ‚ñ∑ liftM2 (Œº R') fŒõ m ‚üßtel p') ‚Üí  f'' (h p) 
            ‚â° g  (VxfO-‚ñ∑-map f (liftM2 (Œº R) fŒò l) (liftM2 (Œº R') fŒõ m)
                 (Œª q w x ‚Üí  transport2 (Œº R) (p‚ÇÅ _ _) (p‚ÇÇ _ _)
                             (ornForget O (fŒõ (q , w)) x)) p))
      ‚Üí ‚àÄ {if if‚Ä≤}
      ‚Üí ‚àÄ {iff iff‚Ä≤}
      ‚Üí ConOrn f e  (Œ¥ {if = if}   {iff = iff}   l fŒò R   g D)
                    (Œ¥ {if = if‚Ä≤}  {iff = iff‚Ä≤}  m fŒõ R'  h E) 
%</Orn-comp>

-- (*) https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGJ1bGxldCJdLFsxLDAsIlxcYnVsbGV0Il0sWzAsMSwiXFxidWxsZXQiXSxbMSwxLCJcXGJ1bGxldCJdLFswLDEsImUiXSxbMiwzLCJmIiwyXSxbMiwwLCJqIl0sWzMsMSwiaSIsMl0sWzMsMCwiayIsMV1d
-- note that having ‚Üí ConOrn f e (ùüô (e ‚àò k)) (ùüô (k ‚àò f)) obviously satisfies the square
-- but if f is split epi, then the square also provides k.
-- f being split epi roughly states "Œî is a more informative parameter than Œì", so is this actually reasonable to ask?

{- diagrams
-- œÉ
https://q.uiver.app/#q=WzAsMTMsWzEsMSwiXFxHYW1tYSxWIl0sWzAsMSwiXFxEZWx0YSxXIl0sWzIsMSwiXFxtYXRocm17VHlwZX0iXSxbMCwwLCJKIl0sWzEsMCwiSSJdLFsxLDIsIlZcXHJoZCBTIl0sWzIsMiwiViciXSxbMSwzLCJXXFxyaGQgKFNcXGNpcmMgZikiXSxbMiwzLCJXJyJdLFszLDIsIlxcR2FtbWEsVlxccmhkIFMiXSxbNCwyLCJcXEdhbW1hLFYnIl0sWzMsMywiXFxEZWx0YSxXXFxyaGQgKFNcXGNpcmMgZikiXSxbNCwzLCJcXERlbHRhLFcnIl0sWzEsMCwiZiJdLFswLDIsIlMiXSxbMyw0LCJlIl0sWzUsNiwiZyJdLFs3LDgsImgiXSxbOSwxMCwiXFxoYXR7Z30iXSxbMTEsMTIsIlxcaGF0e2h9Il0sWzEyLDEwLCJmJyIsMl0sWzExLDksImYgXFxyaGQgUyJdXQ==

-- ŒîœÉ
https://q.uiver.app/#q=WzAsOCxbMCwxLCJXIl0sWzAsMiwiVyciXSxbMiwyLCJcXERlbHRhLFcnXFxyaGQgUyJdLFszLDIsIlxcR2FtbWEsViJdLFs0LDIsIlxcRGVsdGEsVyJdLFsyLDAsIlxcRGVsdGEsIFcnIl0sWzQsMCwiXFxtYXRocm17VHlwZX0iXSxbMywzLCJcXERlbHRhLFdcXHJoZCAoUyBcXGNpcmMgRWgpIl0sWzAsMSwiaCJdLFs0LDMsImYiLDJdLFsyLDUsIlxcbWF0aHJte2ZvcmdldH0iXSxbMiwzLCJmJyJdLFs1LDYsIlMiLDJdLFs0LDYsIlMnPVNcXGNpcmMgRWgiLDJdLFs3LDIsIkVoXFxyaGQgUyJdLFs3LDQsIlxcbWF0aHJte2ZvcmdldH0iLDJdLFs0LDUsIkVoIiwxXV0=

-- ‚àáœÉ
https://q.uiver.app/#q=WzAsNixbMCwxLCJcXERlbHRhLFciXSxbMSwxLCJcXEdhbW1hLFYiXSxbMSwyLCJcXEdhbW1hLCBWJyJdLFsyLDEsIlZcXHJoZCBTIl0sWzIsMiwiViciXSxbMiwwLCJWIl0sWzAsMSwiZiIsMl0sWzAsMiwiZiciLDJdLFszLDQsImciLDJdLFs1LDMsIlxccmhkIHMiLDJdXQ==

-- ‚àôŒ¥
https://q.uiver.app/#q=WzAsMzIsWzAsMCwiRDpcXG1hdGhybXtDb259XFxHYW1tYSBKIFYiXSxbMSwwLCJFOlxcbWF0aHJte0Nvbn1cXERlbHRhIEsgVyJdLFswLDEsIlI6XFxtYXRocm17RGVzY31cXFRoZXRhIEwiXSxbMSwxLCJSJzpcXG1hdGhybXtEZXNjfVxcTGFtYmRhIE0iXSxbNywwLCJcXGRlbHRhIGZfXFxUaGV0YSBsUmdEIl0sWzgsMCwiXFxkZWx0YSBmX1xcTGFtYmRhIG0gUicgaEUiXSxbMiwyLCJcXERlbHRhIl0sWzMsMiwiXFxHYW1tYSJdLFsyLDMsIlxcTGFtYmRhIl0sWzMsMywiXFxUaGV0YSJdLFs0LDIsIlciXSxbNSwyLCJWIl0sWzQsMywiTSJdLFs1LDMsIkwiXSxbNiwyLCJLIl0sWzcsMiwiSiJdLFs2LDMsIk0iXSxbNywzLCJMIl0sWzQsNSwiXFxHYW1tYSxWIl0sWzUsNSwiXFxUaGV0YSJdLFs0LDYsIlxcR2FtbWEsViJdLFs1LDYsIkwiXSxbNiw1LCJcXERlbHRhLFciXSxbNyw1LCJcXExhbWJkYSJdLFs2LDYsIlxcRGVsdGEsVyJdLFs3LDYsIlIiXSxbOCw1LCJWXFxyaGRcXG11IFIiXSxbOSw1LCJWJyJdLFs4LDYsIldcXHJoZFxcbXUgUiciXSxbOSw2LCJXJyJdLFsxMCw1LCJXJyJdLFsxMSw1LCJWJyJdLFswLDEsIiIsMCx7ImxldmVsIjoyfV0sWzIsMywiIiwwLHsibGV2ZWwiOjJ9XSxbNCw1LCIiLDAseyJsZXZlbCI6Mn1dLFs2LDcsImMiXSxbOCw5LCJjJyJdLFsxMCwxMSwiZl9jIl0sWzEyLDEzLCJmX3tjJ30iXSxbMTQsMTUsImUiXSxbMTYsMTcsImUnIl0sWzE4LDE5LCJmX1xcVGhldGEiXSxbMjAsMjEsImwiXSxbMjIsMjMsImZfXFxMYW1iZGEiXSxbMjQsMjUsIm0iXSxbMjYsMjcsImciXSxbMjgsMjksImgiXSxbMzAsMzEsImZfe2MnfSciXV0=

https://q.uiver.app/#q=WzAsMjYsWzAsMCwiRDpcXG1hdGhybXtDb259XFxHYW1tYSBKIFYnIl0sWzEsMCwiRTpcXG1hdGhybXtDb259XFxEZWx0YSBLIFcnIl0sWzAsMSwiUjpcXG1hdGhybXtEZXNjfVxcVGhldGEgTCJdLFsxLDEsIlInOlxcbWF0aHJte0Rlc2N9XFxMYW1iZGEgTSJdLFs3LDAsIlxcZGVsdGEgZl9cXFRoZXRhIGxSZ0QiXSxbOCwwLCJcXGRlbHRhIGZfXFxMYW1iZGEgbSBSJyBoRSJdLFsyLDIsIlxcRGVsdGEiXSxbMywyLCJcXEdhbW1hIl0sWzQsMiwiVyJdLFs1LDIsIlYiXSxbNCwzLCJXJyJdLFs1LDMsIlYnIl0sWzYsMiwiSyJdLFs3LDIsIkoiXSxbMiw1LCJcXEdhbW1hLFYiXSxbMiw0LCJcXFRoZXRhIl0sWzIsNiwiTCJdLFs1LDUsIlxcRGVsdGEsVyJdLFs1LDQsIlxcTGFtYmRhIl0sWzUsNiwiTSJdLFs4LDUsIlZcXHJoZFxcbXUgUiJdLFs5LDUsIlYnIl0sWzgsNiwiV1xccmhkXFxtdSBSJyJdLFs5LDYsIlcnIl0sWzMsNSwiXFxHYW1tYSxWJyJdLFs0LDUsIlxcRGVsdGEsIFcnIl0sWzAsMSwiIiwwLHsibGV2ZWwiOjJ9XSxbMiwzLCIiLDAseyJsZXZlbCI6Mn1dLFs0LDUsIiIsMCx7ImxldmVsIjoyfV0sWzYsNywiYyJdLFs4LDksImYiXSxbMTAsMTEsImYnJyJdLFsxMiwxMywiZSJdLFsxNCwxNSwiZl9cXFRoZXRhIl0sWzE3LDE4LCJmX1xcTGFtYmRhIl0sWzIwLDIxLCJnIl0sWzIyLDIzLCJoIl0sWzIzLDIxLCJmJyciXSxbMjIsMjAsImZcXHJoZCBcXG1hdGhybXtmb3JnZXR9IiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzE4LDE1LCJjJyIsMl0sWzE3LDE5LCJtIl0sWzE0LDE2LCJsIl0sWzE5LDE2LCJlJyJdLFsyNSwyNCwiYyxmJyciXV0=
-}

%<*Orn>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{[]}%
\>[7]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚à∑\AgdaUnderscore{}}}%
\>[7]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{D'}\AgdaSpace{}%
\AgdaBound{E'}\AgdaSymbol{\}}\<%
\\
%
\>[7]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrn}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{c}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D'}\AgdaSpace{}%
\AgdaBound{E'}\<%
\\
%
\>[7]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[7]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{E'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSymbol{)}\<%
\end{code}
%</Orn>


%<*erase-type>
pre‚ÇÇ : (A ‚Üí B ‚Üí C) ‚Üí (X ‚Üí A) ‚Üí (Y ‚Üí B) ‚Üí X ‚Üí Y ‚Üí C
pre‚ÇÇ f a b x y = f (a x) (b y)

erase  : ‚àÄ {D : DescI If Œì J} {E : DescI If‚Ä≤ Œî K} {f} {e} {X : ‚ü¶ Œì ‚üßtel tt ‚Üí J ‚Üí Type}
       ‚Üí Orn f e D E ‚Üí ‚àÄ p k ‚Üí ‚ü¶ E ‚üßD (pre‚ÇÇ X f e) p k ‚Üí ‚ü¶ D ‚üßD X (f p) (e k)
%</erase-type>

erase' : ‚àÄ {V W} {X : ‚ü¶ Œì ‚üßtel tt ‚Üí J ‚Üí Type} {D' : ConI If Œì J V} {E' : ConI If‚Ä≤ Œî K W} {c : Cxf Œî Œì} {f : VxfO c _ _} {e} (O : ConOrn f e D' E') ‚Üí ‚àÄ p k ‚Üí ‚ü¶ E' ‚üßC (pre‚ÇÇ X c e) p k ‚Üí ‚ü¶ D' ‚üßC X (over f p) (e k)

erase (O ‚à∑ Os) p k (inj‚ÇÅ x) = inj‚ÇÅ (erase' O (p , tt) k x)
erase (O ‚à∑ Os) p k (inj‚ÇÇ y) = inj‚ÇÇ (erase Os p k y)

erase' (ùüô j) p k x = ap _ x ‚àô j p
erase' {X = X} (œÅ O q r) p k (x , y) = transport2 X (sym (q _)) (r _) x , erase' O p k y
erase' {X = X} {c = c} (œÉ {D = D} {h = h} f' O q) (p , v) k (s , x) = s , transport (Œª z ‚Üí ‚ü¶ D ‚üßC X z _) (ap (c p ,_) (sym (q _))) (erase' O (p , h (v , s)) k x)
erase' {X = X} {c = c} (Œ¥ {D = D} O q) (p , v) k (r , x) = r , transport (Œª z ‚Üí ‚ü¶ D ‚üßC X z _) (ap (c p ,_) (sym (q _)) ) (erase' O _ k x)
erase' (ŒîœÅ O) (p , v) k (x , y) = erase' O _ k y
erase' {X = X} {c = c} (ŒîœÉ {D = D} f' O q) (p , v) k (x , y) = transport (Œª z ‚Üí ‚ü¶ D ‚üßC X z _) (ap (c p ,_) (sym (q _))) (erase' O _ k y)
erase' {X = X} {c = c} (ŒîŒ¥ {D = D} O q) (p , v) k (x , y) = transport (Œª z ‚Üí ‚ü¶ D ‚üßC X z _) (ap (c p ,_) (sym (q _))) (erase' O _ k y)
erase' (‚àáœÉ s O) (p , v) k x = s _ , erase' O _ k x
erase' (‚àáŒ¥ s O) (p , v) k x = s _ , erase' O _ k x
erase' {X = X} {c = c} (‚àôŒ¥ {D = D} DE RR' p‚ÇÅ p‚ÇÇ p‚ÇÉ) (p , v) k (x , y) = transport2 (Œº _) (p‚ÇÅ _ _) (p‚ÇÇ _ _) (ornForget RR' _ x) , transport (Œª z ‚Üí ‚ü¶ D ‚üßC X z _) (ap (c p ,_) (p‚ÇÉ _)) (erase' DE _ _ y)

%<*ornAlg>
ornAlg  : ‚àÄ {D : DescI If Œì J} {E : DescI If‚Ä≤ Œî K} {f} {e}
        ‚Üí Orn f e D E
        ‚Üí ‚ü¶ E ‚üßD (Œª p k ‚Üí Œº D (f p) (e k)) ‚á∂ Œª p k ‚Üí Œº D (f p) (e k)
ornAlg O p k x = con (erase O p k x)
%</ornAlg>

%<*ornForget>
ornForget O p = fold (ornAlg O) p _
%</ornForget>

Examples
\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ornaments}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Descriptions}\<%
\end{code}

%<*NatD-ListD>
\begin{code}%
%
\>[2]\AgdaFunction{NatD-ListD}%
\>[14]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaFunction{NatD}\AgdaSpace{}%
\AgdaFunction{ListD}\<%
\\
%
\>[2]\AgdaFunction{NatD-ListD}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}%
\>[17]\AgdaInductiveConstructor{ŒîœÉ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[14]\AgdaSymbol{(}%
\>[17]\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[14]\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</NatD-ListD>

%<*ListD-VecD>
\begin{code}%
%
\>[2]\AgdaFunction{ListD-VecD}%
\>[14]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Orn}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaFunction{ListD}\AgdaSpace{}%
\AgdaFunction{VecD}\<%
\\
%
\>[2]\AgdaFunction{ListD-VecD}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}%
\>[17]\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[14]\AgdaSymbol{(}%
\>[17]\AgdaInductiveConstructor{ŒîœÉ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[14]\AgdaSymbol{(}%
\>[17]\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[14]\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</ListD-VecD>
