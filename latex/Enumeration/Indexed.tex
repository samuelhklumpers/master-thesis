\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--with-K}\AgdaSpace{}%
\AgdaPragma{--guardedness}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Enumeration.Indexed}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rec}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{mapL}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Instances}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Codata.Musical.Colist}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Effect.Monad}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Cubical.Data.Sigma}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Cubical.Data.Nat}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{RawMonad}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPrimitive{ℓ-zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{listMonad}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{Ix}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\end{code}

%<*hierarchy>
\begin{code}%
\>[0]\AgdaFunction{Hierarchy}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Ix}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Ix}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaFunction{Hierarchy}\AgdaSpace{}%
\AgdaBound{Ix}\AgdaSpace{}%
\AgdaBound{F}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Colist}\AgdaSpace{}%
\AgdaBound{Ix}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Ix}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{F}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)))}\<%
\end{code}
%</hierarchy>


%<*Desc>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{one}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\>[2]\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{I}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊕\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{I}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{IDesc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Ix}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaFunction{IDesc}\AgdaSpace{}%
\AgdaBound{Ix}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Ix}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaBound{Ix}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Desc}\AgdaSpace{}%
\AgdaGeneralizable{Ix}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{Ix}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{one}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}%
\>[10]\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaBound{X}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{μ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{IDesc}\AgdaSpace{}%
\AgdaGeneralizable{Ix}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{Ix}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{con}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{μ}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{μ}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{i}\<%
\end{code}
%</Desc>

<%*Counter>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Counter}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Counter}\AgdaSpace{}%
\AgdaNumber{2}\<%
\\
%
\>[2]\AgdaInductiveConstructor{no}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Counter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{·}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Counter}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{3}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{·}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{counter-3}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Counter}\AgdaSpace{}%
\AgdaNumber{3}\<%
\\
\>[0]\AgdaFunction{counter-3}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\<%
\end{code}
<%/Counter>


-- \begin{code}%
\>[0]\AgdaComment{--\ mapH\ :\ (A\ →\ B)\ →\ Hierarchy\ A\ →\ Hierarchy\ B}\<%
\\
\>[0]\AgdaComment{--\ mapH\ f\ V\ n\ with\ V\ n}\<%
\\
\>[0]\AgdaComment{--\ ...\ |\ c\ ,\ xs\ =\ c\ ,\ mapL\ f\ xs}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \%<*pure>}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ pure\ :\ A\ →\ Hierarchy\ A}\<%
\\
\>[0]\AgdaComment{--\ pure\ x\ zero\ \ \ \ =\ 1\ ,\ [\ x\ ]}\<%
\\
\>[0]\AgdaComment{--\ pure\ x\ (suc\ n)\ =\ 0\ ,\ []}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ \%</pure>}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ interleave\ :\ List\ A\ →\ List\ A\ →\ List\ A}\<%
\\
\>[0]\AgdaComment{--\ interleave\ []\ ys\ =\ ys}\<%
\\
\>[0]\AgdaComment{--\ interleave\ (x\ ∷\ xs)\ ys\ =\ x\ ∷\ interleave\ ys\ xs}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \%<*alternative>}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ \AgdaUnderscore{}⟨∣⟩\AgdaUnderscore{}\ :\ Hierarchy\ A\ →\ Hierarchy\ B\ →\ Hierarchy\ (A\ ⊎\ B)}\<%
\\
\>[0]\AgdaComment{--\ (V₁\ ⟨∣⟩\ V₂)\ n\ with\ V₁\ n\ |\ V₂\ n}\<%
\\
\>[0]\AgdaComment{--\ ...\ |\ c₁\ ,\ xs\ |\ c₂\ ,\ ys\ =\ c₁\ +\ c₂\ ,\ interleave\ (mapL\ inl\ xs)\ (mapL\ inr\ ys)}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ \%</alternative>}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ prod\ :\ List\ A\ →\ List\ B\ →\ List\ (A\ ×\ B)}\<%
\\
\>[0]\AgdaComment{--\ prod\ []\ \ \ \ \ \ \ ys\ \ \ \ \ \ \ =\ []}\<%
\\
\>[0]\AgdaComment{--\ prod\ (x\ ∷\ xs)\ []\ \ \ \ \ \ \ =\ []}\<%
\\
\>[0]\AgdaComment{--\ prod\ (x\ ∷\ xs)\ (y\ ∷\ ys)\ =\ (x\ ,\ y)\ ∷\ interleave\ (mapL\ (x\ ,\AgdaUnderscore{})\ ys)\ (prod\ xs\ (y\ ∷\ ys))}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ \AgdaUnderscore{}++′\AgdaUnderscore{}\ :\ (l\ r\ :\ ℕ\ ×\ List\ A)\ →\ ℕ\ ×\ List\ A}\<%
\\
\>[0]\AgdaComment{--\ (n\ ,\ xs)\ ++′\ (m\ ,\ ys)\ =\ n\ +\ m\ ,\ xs\ ++\ ys}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ prod′\ :\ ℕ\ ×\ List\ A\ →\ ℕ\ ×\ List\ B\ →\ ℕ\ ×\ List\ (A\ ×\ B)}\<%
\\
\>[0]\AgdaComment{--\ prod′\ (n\ ,\ xs)\ (m\ ,\ ys)\ =\ n\ ·\ m\ ,\ prod\ xs\ ys}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ ⊛-left\ :\ Hierarchy\ A\ →\ Hierarchy\ B\ →\ ℕ\ →\ Hierarchy\ (A\ ×\ B)}\<%
\\
\>[0]\AgdaComment{--\ ⊛-left\ V₁\ V₂\ n\ zero\ \ \ \ =\ prod′\ (V₁\ n)\ (V₂\ 0)}\<%
\\
\>[0]\AgdaComment{--\ ⊛-left\ V₁\ V₂\ n\ (suc\ m)\ =\ prod′\ (V₁\ n)\ (V₂\ (suc\ m))\ ++′\ ⊛-left\ V₁\ V₂\ n\ m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ ⊛-right\ :\ Hierarchy\ A\ →\ Hierarchy\ B\ →\ ℕ\ →\ Hierarchy\ (A\ ×\ B)}\<%
\\
\>[0]\AgdaComment{--\ ⊛-right\ V₁\ V₂\ n\ zero\ \ \ \ =\ 0\ ,\ []}\<%
\\
\>[0]\AgdaComment{--\ ⊛-right\ V₁\ V₂\ n\ (suc\ m)\ =\ prod′\ (V₁\ m)\ (V₂\ n)\ ++′\ ⊛-right\ V₁\ V₂\ n\ m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ \AgdaUnderscore{}⊛\AgdaUnderscore{}\ :\ Hierarchy\ A\ →\ Hierarchy\ B\ →\ Hierarchy\ (A\ ×\ B)}\<%
\\
\>[0]\AgdaComment{--\ (V₁\ ⊛\ V₂)\ n\ =\ ⊛-left\ V₁\ V₂\ n\ n\ ++′\ ⊛-right\ V₁\ V₂\ n\ n}\<%
\\
\>[0]\AgdaComment{--\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \%<*ghierarchy>}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \{-\#\ TERMINATING\ \#-\}}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ :\ ∀\ D\ \{E\}\ →\ Hierarchy\ (⟦\ D\ ⟧\ (μ\ E))}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ one\ \ \ \ \ =\ pure\ tt}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ var\ zero\ \ \ \ =\ 0\ ,\ []}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ var\ (suc\ n)\ =\ mapH\ con\ (ghierarchy\ \AgdaUnderscore{})\ n}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ (D\ ⊗\ E)\ =\ ghierarchy\ D\ \ ⊛\ \ ghierarchy\ E}\<%
\\
\>[0]\AgdaComment{--\ --\ ghierarchy\ (D\ ⊕\ E)\ =\ ghierarchy\ D\ ⟨∣⟩\ ghierarchy\ E}\<%
\\
\>[0]\AgdaComment{--\ --\ --\ note\ that\ the\ termination\ checker\ also\ does\ not\ like\ this\ case,}\<%
\\
\>[0]\AgdaComment{--\ --\ --\ so\ inline\ it\ if\ you\ want\ to\ get\ rid\ of\ the\ pragma}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \%</ghierarchy>}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ hierarchy\ :\ ∀\ D\ →\ Hierarchy\ (μ\ D)}\<%
\\
\>[0]\AgdaComment{--\ --\ hierarchy\ D\ =\ mapH\ con\ (ghierarchy\ D)}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \%<*TreeD>}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ TreeD\ :\ Desc}\<%
\\
\>[0]\AgdaComment{--\ --\ TreeD\ =\ one\ ⊕\ (var\ ⊗\ var)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ TreeH\ =\ hierarchy\ TreeD}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \%</TreeD>}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ Tree′\ =\ μ\ TreeD}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ data\ Tree\ :\ Type\ where}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ leaf\ :\ Tree}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ node\ :\ Tree\ →\ Tree\ →\ Tree}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ conversion\ :\ Tree′\ →\ Tree}\<%
\\
\>[0]\AgdaComment{--\ --\ conversion\ (con\ (inl\ \AgdaUnderscore{}))\ \ \ \ \ \ \ =\ leaf}\<%
\\
\>[0]\AgdaComment{--\ --\ conversion\ (con\ (inr\ (l\ ,\ r)))\ =\ node\ (conversion\ l)\ (conversion\ r)}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \%<*numTrees>}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ numTrees\ :\ ℕ\ →\ ℕ}\<%
\\
\>[0]\AgdaComment{--\ --\ numTrees\ n\ =\ fst\ (TreeH\ n)}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \%</numTrees>}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ trees\ :\ ℕ\ →\ List\ Tree}\<%
\\
\>[0]\AgdaComment{--\ --\ trees\ n\ =\ mapL\ conversion\ (snd\ (TreeH\ n))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ --\ trees-2\ :\ List\ Tree}\<%
\\
\>[0]\AgdaComment{--\ --\ trees-2\ =}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \%<*trees-2>}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}begin\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ \ \ node\ (node\ leaf\ leaf)\ (node\ leaf\ leaf)}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ ∷\ node\ (node\ leaf\ leaf)\ leaf}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ ∷\ node\ leaf\ \ \ \ \ \ \ \ \ \ \ \ \ (node\ leaf\ leaf)}\<%
\\
\>[0]\AgdaComment{--\ --\ \ \ ∷\ []}\<%
\\
\>[0]\AgdaComment{--\ --\ \textbackslash{}end\{code\}}\<%
\\
\>[0]\AgdaComment{--\ --\ \%</trees-2>}\<%
