\documentclass[Main.tex]{subfiles}

\begin{document}
\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--cubical}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Leibniz.Base}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Extra.Algebra}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Cubical.Data.Nat.Base}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{N}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Cubical.Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{20}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}1b}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}2b}}\<%
\end{code}

The type of the 1-2 binary numbers
%<*Leibniz>
\AgdaTarget{Leibniz}
\AgdaTarget{0b}
\AgdaTarget{1b, \_1b}
\AgdaTarget{2b, \_2b}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{0b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}1b}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
%
\>[4]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}2b}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\end{code}
%</Leibniz>

The successor operation on binary numbers
%<*bsuc>
\AgdaTarget{bsuc}
\begin{code}%
\>[0]\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
\>[0]\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}%
\>[12]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\<%
\\
\>[0]\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\<%
\\
\>[0]\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\<%
\end{code}
%</bsuc>

Addition on binary numbers
%<*plus>
\AgdaTarget{_+_}
{- _+_ : Leibniz → Leibniz → Leibniz
0b     + y  = y
x      + 0b = x
(x 1b) + (y 1b) = (x + y) 2b
(x 1b) + (y 2b) = bsuc (x + y) 1b
(x 2b) + (y 1b) = bsuc (x + y) 1b
(x 2b) + (y 2b) = bsuc (x + y) 2b -}
%</plus>

Right shift the binary number by a peano number of steps
%<*shiftr>
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{N.ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
\>[0]\AgdaInductiveConstructor{ℕ.zero}%
\>[8]\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaBound{y}%
\>[18]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}%
\>[18]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}\<%
\\
\>[0]\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaInductiveConstructor{ℕ.suc}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaBound{y}\<%
\end{code}
%</shiftr>

\begin{code}%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{6}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\<%
\end{code}

Inequality on binary numbers
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{0b<1b}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[18]\AgdaInductiveConstructor{0b}%
\>[23]\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\<%
\\
%
\>[2]\AgdaInductiveConstructor{0b<2b}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[18]\AgdaInductiveConstructor{0b}%
\>[23]\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\<%
\\
%
\>[2]\AgdaInductiveConstructor{1b<1b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\<%
\\
%
\>[2]\AgdaInductiveConstructor{1b<2b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\<%
\\
%
\>[2]\AgdaInductiveConstructor{2b<1b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\<%
\\
%
\>[2]\AgdaInductiveConstructor{2b<2b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{<}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\<%
\end{code}

From peano to leibniz
%<*fromN>
\AgdaTarget{fromℕ}
\begin{code}%
\>[0]\AgdaFunction{fromℕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\<%
\\
\>[0]\AgdaFunction{fromℕ}\AgdaSpace{}%
\AgdaNumber{0}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}\<%
\\
\>[0]\AgdaFunction{fromℕ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{bsuc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℕ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\end{code}
%</fromN>

\begin{code}%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟦\AgdaUnderscore{}⟧}}\<%
\end{code}

From leibniz to peano
%<*toN>
\AgdaTarget{toℕ}
\begin{code}%
\>[0]\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Leibniz}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
\>[0]\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaInductiveConstructor{0b}%
\>[11]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\<%
\\
\>[0]\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{1b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{N.+}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{N.·}}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{2b}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{N.+}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{N.·}}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSpace{}%
\AgdaBound{n}\<%
\end{code}
%</toN>

%<*toN-2>
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{toℕ}\<%
\end{code}
%</toN-2>
\end{document}
