\begin{code}%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--type-in-type}\AgdaSpace{}%
\AgdaPragma{--with-K}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ornament.Numerical}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Primitive}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}%
\>[11]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPostulate{Level}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{SSet}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}%
\>[12I]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaPrimitive{lzero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-zero}\<%
\\
\>[.][@{}l@{}]\<[12I]%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{lsuc}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{‚Ñì-suc}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}‚äî\AgdaUnderscore{}}}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{‚Ñì-max}}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Set}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[11]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPrimitive{Setœâ}%
\>[19]\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPrimitive{Typeœâ}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{J}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Vec}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{fst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{snd}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map‚ÇÇ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.Desc}\<%
\\
\>[0]\AgdaComment{--open\ import\ Ornament.Orn}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Ornament.OrnDesc}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≤}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä≥}\AgdaSpace{}%
\AgdaGeneralizable{If‚Ä¥}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
%
\>[2]\AgdaGeneralizable{I}\AgdaSpace{}%
\AgdaGeneralizable{J}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaGeneralizable{X}\AgdaSpace{}%
\AgdaGeneralizable{Y}\AgdaSpace{}%
\AgdaGeneralizable{Z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\>[2]\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\AgdaSpace{}%
\AgdaGeneralizable{Œò}\AgdaSpace{}%
\AgdaGeneralizable{Œõ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tel}\AgdaSpace{}%
\AgdaGeneralizable{P}\<%
\\
%
\>[2]\AgdaGeneralizable{D}\AgdaSpace{}%
\AgdaGeneralizable{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{I}\<%
\\
%
\>[2]\AgdaGeneralizable{U}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{W}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\<%
\\
%
\>[2]\AgdaGeneralizable{CD}\AgdaSpace{}%
\AgdaGeneralizable{CE}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaGeneralizable{I}\<%
\\
%
\>[2]\AgdaGeneralizable{V‚Ä≤}\AgdaSpace{}%
\AgdaGeneralizable{W‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ExTel}\AgdaSpace{}%
\AgdaGeneralizable{Œî}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Info}\<%
\end{code}

%<*Number>
\begin{code}%
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Info}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôi}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅi}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉi}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥i}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{J}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{√ó}}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\end{code}
%</Number>

%<*toN-type>
\begin{code}%
\>[0]\AgdaFunction{value}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\end{code}
%</toN-type>

\begin{code}%
\>[0]\AgdaFunction{value}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{value-lift}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{value-lift}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Œº}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaFunction{value-lift}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{If}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{If}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fold}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{value-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\end{code}

%<*toN-con>
\begin{code}%
%
\>[4]\AgdaFunction{value-desc}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßD}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
%
\>[4]\AgdaFunction{value-con}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaBound{If}\AgdaSpace{}%
\AgdaGeneralizable{Œì}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ü¶}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚üßC}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{value-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÅ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{value-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaFunction{value-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj‚ÇÇ}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{value-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{value-con}%
\>[15]\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôf}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{value-con}%
\>[15]\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[52]\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{value-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{value-con}%
\>[15]\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{S‚Üí‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[52]\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{S‚Üí‚Ñï}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{value-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{value-con}%
\>[15]\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}%
\>[52]\AgdaSymbol{(}\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\<%
\\
%
\>[4]\AgdaSymbol{...}%
\>[13]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaFunction{value-lift}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àòInfoF}}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{value-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
%</toN-con>

%<*NatND>
\begin{code}%
\>[0]\AgdaFunction{NatND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{NatND}%
\>[346I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[346I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</NatND>

\begin{code}%
\>[0]\AgdaFunction{BinND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
\>[0]\AgdaFunction{BinND}%
\>[368I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[.][@{}l@{}]\<[368I]%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\<%
\\
%
\>[6]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}

bin-2 : Œº BinND tt tt
bin-2 = con (inr (inr (inl (con (inl refl) , refl))))

bin-5 : Œº BinND tt tt
bin-5 = con (inr (inl (con (inr (inr (inl (con (inl refl) , refl)))) , refl)))

-- simple the number system underlying simple finger trees
DigND : DescI Number ‚àÖ ‚ä§
DigND = ùüô {if = 1} _
      ‚à∑ ùüô {if = 2} _
      ‚à∑ ùüô {if = 3} _
      ‚à∑ []

FingND : DescI Number ‚àÖ ‚ä§
FingND = ùüô {if = 0} _
       ‚à∑ ùüô {if = 1} _
       ‚à∑ Œ¥- {if = refl , refl , 1} {iff = id-InfoF} _ _ DigND (œÅ0 {if = 2} _ (Œ¥- {if = refl , refl , 1} {iff = id-InfoF} _ _ DigND (ùüô {if = 0} _)))
       ‚à∑ []

-- 1 ‚ü® 0 ‚ü© 1
finger-2 : Œº FingND tt tt
finger-2 = con (inr (inr (inl (con (inl refl) , con (inl refl) , con (inl refl) , refl))))

-- 1 ‚ü® 2 ‚ü© 2
finger-7 : Œº FingND tt tt
finger-7 = con (inr (inr (inl (con (inl refl) , finger-2 , con (inr (inl refl)) , refl))))


Theorem: given a number system D, there is a "good container" D', which also satisfies (x : Œº D' A tt) ‚Üí size x ‚â° shape x
%<*trieifyOD>
\begin{code}%
\>[0]\AgdaFunction{trieifyOD}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{D}\<%
\\
\>[0]\AgdaFunction{trieifyOD}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trie-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{trieifyOD}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\>[2]\AgdaFunction{trie-desc}%
\>[420I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\<%
\\
\>[420I][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{D}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaFunction{trie-con}%
\>[12]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{VxfO}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaGeneralizable{W}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ConI}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaGeneralizable{V}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{InfoF}\AgdaSpace{}%
\AgdaGeneralizable{If}\AgdaSpace{}%
\AgdaFunction{Number}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ConOrnDesc}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{Œî}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{W}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaGeneralizable{W}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{J}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaBound{C}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{trie-desc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[20]\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaFunction{trie-desc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{D}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{trie-desc}\AgdaSpace{}%
\AgdaBound{D}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ùüôf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÅf}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{œÉ}\AgdaSpace{}%
\AgdaBound{S}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OœÉ+}\AgdaSpace{}%
\AgdaBound{S}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{œÉf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Œ¥}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{if}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{h}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{œï}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Œ¥f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{if}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{O‚àôŒ¥+}%
\>[12]\AgdaFunction{!}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{trie-desc}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œï}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àòInfoF}}\AgdaSpace{}%
\AgdaBound{iff}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{trie-con}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaBound{œï}\AgdaSymbol{)}\<%
\end{code}
%</trieifyOD>


\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{PhalanxND}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
%<*PhalanxND>
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaFunction{ThreeND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
%
\>[2]\AgdaFunction{ThreeND}%
\>[11]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[11]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[11]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[11]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{PhalanxND}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{DescI}\AgdaSpace{}%
\AgdaFunction{Number}\AgdaSpace{}%
\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaRecord{‚ä§}\<%
\\
%
\>[2]\AgdaFunction{PhalanxND}%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[13]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[13]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{Œ¥-}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{ThreeND}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{œÅ0}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{Œ¥-}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{iff}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id-InfoF}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{ThreeND}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{if}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})))}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</PhalanxND>

%<*DigitOD-2>
\begin{code}%
%
\>[2]\AgdaFunction{DigitOD‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaFunction{ThreeND}\<%
\\
%
\>[2]\AgdaFunction{DigitOD‚Ä≤}%
\>[12]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%</DigitOD-2>

%<*FingerOD-2>
\begin{code}%
%
\>[2]\AgdaFunction{FingerOD‚Ä≤}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{OrnDesc}\AgdaSpace{}%
\AgdaFunction{Plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{‚àÖ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ñ∑}}\AgdaSpace{}%
\AgdaFunction{const}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaRecord{‚ä§}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaFunction{PhalanxND}\<%
\\
%
\>[2]\AgdaFunction{FingerOD‚Ä≤}%
\>[13]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[13]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\<%
\\
%
\>[13]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaFunction{O‚àôŒ¥+}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{DigitOD‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{œÅ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{O‚àôŒ¥+}\AgdaSpace{}%
\AgdaFunction{!}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{DigitOD‚Ä≤}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{OŒîœÉ-}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaSymbol{((\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
%
\>[13]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{const}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{)))}\<%
\\
%
\>[13]\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}
%<*FingerOD-2>






_L+_ : List (ConI If Œì J ‚àÖ) ‚Üí DescI If Œì J ‚Üí DescI If Œì J
[]        L+ D = D
(C ‚à∑ Cs)  L+ D = C ‚à∑ (Cs L+ D)

PathD : (D : DescI Number ‚àÖ ‚ä§) ‚Üí Desc ‚àÖ (Œº D tt tt)
PathD‚Ä≤ : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí Desc ‚àÖ (Œº D tt tt)

PathD E = PathD‚Ä≤ E id-InfoF
PathD‚Ä≤ E if = PathDD E if Œª a b ‚Üí con
  module PathD where
    N : _
    N = Œº E tt tt

    PathDD : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí (‚ü¶ D ‚üß (Œª _ _ ‚Üí N) ‚á∂ Œª _ _ ‚Üí N) ‚Üí Desc ‚àÖ (Œº E tt tt)
    PathDC : (C : ConI If ‚àÖ ‚ä§ V) (if : InfoF If Number) (f : Vxf ‚àÖ W V) ‚Üí (‚àÄ b ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (tt , f b) _ ‚Üí N) ‚Üí List (Con ‚àÖ (Œº E tt tt) W)

    PathDD []      if œï = []
    PathDD (C ‚à∑ D) if œï = PathDC C if id (Œª _ c ‚Üí œï _ _ (inl c)) L+ PathDD D if Œª p i ‚Üí œï p i ‚àò inr

    PathDC (ùüô {if = k} j) if f œï
      = œÉ- (const (Fin (if .ùüôf k))) (ùüô (Œª { (_ , w) ‚Üí œï w refl }))
      ‚à∑ []

    -- looks scary, pretty regular to write down though
    PathDC (œÅ {if = k} j g C) if f œï
      = œÉ- (const (Fin (if .œÅf k))) (œÉ+ (const N) (œÉ+ (Œª { (p , w , _) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , f w) tt }) (œÅ0 (snd ‚àò fst ‚àò snd) (ùüô Œª { (_ , (w , n) , c) ‚Üí œï w (n , c) }))))
      ‚à∑ L.map (œÉ+ (const N)) (PathDC C if (f ‚àò fst) (Œª { (w , n) c ‚Üí œï w (n , c) }))

    PathDC (œÉ S {if = k} h C)     if f œï
      = œÉ+ (Œª { (p , w) ‚Üí S (p , f w) }) (œÉ+ (Œª { (p , w , s) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , h (f w , s)) tt }) (œÉ- (Œª { (p , (w , s) , c) ‚Üí Fin (if .œÉf _ k (p , f w) s) }) (ùüô Œª { (p , (w , s) , c) ‚Üí œï w (s , c) })))
      ‚à∑ L.map (œÉ+ Œª { (p , w) ‚Üí S (p , f w) }) (PathDC C if (h ‚àò Vxf-‚ñ∑ f S) Œª { (w , s) c ‚Üí œï w (s , c) })

    PathDC (Œ¥ {If‚Ä≤ = If‚Ä≤} {if = k} {iff = iff} j g R h C) if f œï with if .Œ¥f _ _ k
    ... | refl , refl , k
      = œÉ- (const (Fin k)) (œÉ+ (const (Œº R tt tt)) (œÉ+ (Œª { (p , w , r) ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (p , h (f w , r)) tt }) (Œ¥- (snd ‚àò fst ‚àò snd) ! (PathD‚Ä≤ R (if ‚àòInfoF iff)) (ùüô Œª { (p , (w , r) , c) ‚Üí œï w (r , c) }))))
      ‚à∑ L.map (Œ¥+ ! ! R) (PathDC C if (Œª { (w , r) ‚Üí h (f w , r) }) Œª { (w , r) c ‚Üí œï w (r , c) })

unŒº : {D : DescI If Œì J} ‚Üí ‚àÄ {p i} ‚Üí Œº D p i ‚âÉ ‚ü¶ D ‚üß (Œº D) p i
unŒº .fst (con x) = x
unŒº .snd .equiv-proof y .fst = con y , Œª i ‚Üí y
unŒº .snd .equiv-proof y .snd (con x , p) = Œ£PathP ((Œª i ‚Üí con (p (~ i))) , Œª j i ‚Üí p (~ j ‚à® i))

PathD-correct : ‚àÄ D n ‚Üí Œº (PathD D) tt n ‚âÉ Fin (value n)
PathD-correct D n = compEquiv unŒº {!compEquiv (go D id-InfoF n) {!!}!}
  where
  open PathD D

  go :  (E : DescI If ‚àÖ ‚ä§) (if : InfoF If Number)
        (c : ‚ü¶ E ‚üß (Œª _ _ ‚Üí N id-InfoF) ‚á∂ (Œª _ _ ‚Üí N id-InfoF))
     ‚Üí  ‚àÄ n ‚Üí ‚ü¶ PathDD id-InfoF E if c ‚üß (Œº (PathD D)) tt n ‚âÉ ‚ü¶ PathDD id-InfoF E if c ‚üß (Œª _ n ‚Üí Fin (value n)) tt n
     
  go2 : (E : ConI If ‚àÖ ‚ä§ V) (if : InfoF If Number) ‚Üí ‚àÄ n v ‚Üí ‚ü¶ {!PathDC!} ‚üß (Œº (PathD D)) (tt , v) n ‚âÉ ‚ü¶ {!!} ‚üß (Œª _ n ‚Üí Fin (value n)) (tt , v) n

  go []       _  _ _ = idEquiv ‚ä•
  go (E ‚à∑ Es) if c n = {!‚ü¶ PathDD id-InfoF (E ‚à∑ Es) if c ‚üß (Œº (PathD D)) tt n!}
  
  --go []       n = {!idEquiv ‚ä•!}
  --go (E ‚à∑ Es) n = {!‚äé-equiv (go2 E n tt) (go Es n)!}

  go2 E n = {!!}


BinID : Desc ‚àÖ (Œº BinND tt tt)
BinID = PathD BinND

BinI : Œº BinND tt tt ‚Üí Type
BinI n = Œº BinID tt n

-- the constructors are
-- i0  : ‚ä• ‚Üí BinI 0
-- 1b1 : 2 ‚Üí BinI n ‚Üí BinI (n 1b)
-- 1b0 : 1 ‚Üí BinI (n 1b)
-- 2b1 : 2 ‚Üí BinI n ‚Üí BinI (n 2b)
-- 2b0 : 2 ‚Üí BinI (n 2b)
-- (I think)

-- like the 3rd index into bin-5
bin-3/5 : BinI bin-5
bin-3/5 = con (inr (inl (# 1 , _ , (refl , ((con (inr (inr (inr (inr (inl (_ , (# 0 , refl)))))))) , refl)))))

ITrieO : (D : DescI Number ‚àÖ ‚ä§) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D tt tt) ! (toDesc (TrieO D))
ITrieO D = ITrieO‚Ä≤ D D id-InfoF
  module ITrieO where
    module _ (D' : DescI Number ‚àÖ ‚ä§) where
      ITrieO‚Ä≤ : (D : DescI If ‚àÖ ‚ä§) (if : InfoF If Number) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D' tt tt) ! (toDesc (TrieO.TrieO-desc D' D if))
      
      N : _
      N = Œº D' tt tt

      ITrieO-desc : (D : DescI If ‚àÖ ‚ä§) ‚Üí (‚ü¶ D ‚üß (Œª _ _ ‚Üí N) ‚á∂ Œª _ _ ‚Üí N) ‚Üí (if : InfoF If Number) ‚Üí OrnDesc Plain (‚àÖ ‚ñ∑ const Type) id (Œº D' tt tt) ! (toDesc (TrieO.TrieO-desc D' D if))

      ITrieO-con  : ‚àÄ {U V} {W : ExTel (‚àÖ ‚ñ∑ const Type)} {f : VxfO ! U V} {g : VxfO id W U}
                 (C : ConI If ‚àÖ ‚ä§ V) ‚Üí (‚àÄ a b ‚Üí ‚ü¶ C ‚üß (Œª _ _ ‚Üí N) (tt , f (g {p = a} b)) _ ‚Üí N) ‚Üí (if : InfoF If Number)
                 ‚Üí ConOrnDesc Plain {W = W} {K = Œº D' tt tt} g ! (toCon {f = f} (TrieO.TrieO-con D' C if))

      ITrieO-desc []      œï if = []
      ITrieO-desc (C ‚à∑ D) œï if = ITrieO-con C (Œª a b x ‚Üí œï tt b (inl x)) if ‚à∑ (ITrieO-desc D (œï ‚àò‚ÇÉ inr) if)
      
      ITrieO-con {f = f} {g = g} (ùüô {if = k} j) œï if
        = œÉ _ id (g ‚àò fst) (ùüô (Œª { (p , w , _) ‚Üí œï p w refl }) Œª p ‚Üí refl) (Œª p ‚Üí refl)

      ITrieO-con {f = f} {g = g} (œÅ {if = k} j h C) œï if
        = ŒîœÉ (const N) (g ‚àò fst) id
        ( œÅ (Œª (p , w , n) ‚Üí n) (Œª { (_ , A) ‚Üí _ , Vec A (if .œÅf k) })
          (ITrieO-con C (Œª { a (u , n) x ‚Üí œï a u (n , x) }) if)
        (Œª p ‚Üí refl) (Œª p ‚Üí refl)) (Œª p ‚Üí refl)
        
      ITrieO-con {f = f} {g = g} (œÉ S {if = k} h C)      œï if
        = œÉ _ id (VxfO-‚ñ∑ g (S ‚àò over f))
        ( œÉ _ id (VxfO-‚ñ∑ (VxfO-‚ñ∑ g (S ‚àò over f)) (Œª { ((_ , A) , _ , s) ‚Üí Vec A (if .œÉf _ k _ s) }))
          (ITrieO-con C (Œª { a ((w , s) , _) x ‚Üí œï a w (s , x) }) if)
        Œª p ‚Üí refl) Œª p ‚Üí refl
        
      ITrieO-con {f = f} {g = g} (Œ¥ {if = k} {iff = iff} j g' R h C) œï if with if .Œ¥f _ _ k
      ... | refl , refl , k
        = ŒîœÉ (const (Œº R tt tt)) (g ‚àò fst) id
        ( ŒîœÉ (const (Œº D' tt tt)) (g ‚àò fst ‚àò fst) id
        ( ‚àôŒ¥ {f'' = VxfO-‚ñ∑-map (g ‚àò fst ‚àò fst)
                     (liftM2 (Œº (toDesc (TrieO.TrieO-desc D' R (if ‚àòInfoF iff)))) (Œª { ((_ , A) , _) ‚Üí tt , Vec A k }) !)
                     (liftM2 (Œº (toDesc (ITrieO-desc R {!!} (if ‚àòInfoF iff)))) (Œª p ‚Üí tt , Vec (id (p .fst) .snd) k) (Œª x ‚Üí snd (snd x)))
                     {!!} }
             (Œª { ((_ , A) , ((w , r) , _)) ‚Üí tt , Vec A k }) (snd ‚àò snd)
          (ITrieO-con C {!Œª { a (((w , r) , n) , _)  x ‚Üí œï a w (r , {!!}) }!} if)
          {!ITrieO R!} id
        (Œª _ _ ‚Üí refl) (Œª _ _ ‚Üí refl) Œª p ‚Üí refl) Œª p ‚Üí refl) Œª p ‚Üí refl
    
      ITrieO‚Ä≤ D if = ITrieO-desc D {!!} if


--(liftM2 (Œº (toDesc (TrieO.TrieO-desc D' R (if ‚àòInfoF iff)))) (Œª { ((_ , A) , _) ‚Üí tt , Vec A k }) !)
--ITrieO-desc R (Œª { a b x ‚Üí œï {!!} {!!} {!!} }) (if ‚àòInfoF iff)

-- to prove: size x ‚â° shape x
-- * Œº D is likely to be Traversable when all œÉ's in it are
-- * as every S in a DescI Number ‚àÖ ‚ä§ is necessarily invariant, it is also trivially Traversable

-- to prove: every OrnDesc induces an ornamental algebra -> doesn't work
-- to prove: for some appropriate Ix : (D : DescI Number ‚àÖ ‚ä§) ‚Üí Desc ‚àÖ (Œº D tt tt),
--           Ix D is also initial for the algebra of the algebraic ornament induced by the ornamental algebra (yes)

-- to summarize, for every number system, there is an appropriate "list", which has an appropriate "vector"
-- this vector is representable, the list is traversable, and everything still satisfies size ‚â° shape ‚â° index

UnitD : DescI Number ‚àÖ ‚ä§
UnitD = ùüô {if = 1} _
      ‚à∑ []


